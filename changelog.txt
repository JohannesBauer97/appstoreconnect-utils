Improvements and minor bug fixes
